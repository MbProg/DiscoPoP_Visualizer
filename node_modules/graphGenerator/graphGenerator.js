var dagre = require('dagre');
var ipc = require("electron").ipcMain;
var _ = require('lodash/core');


function buildGraph(data) {

  var g = new dagre.graphlib.Graph();

  g.setGraph({});
  g.setDefaultEdgeLabel(function() { return {}; });

  _.forEach(data, function(value, key) {
    g.setNode(value.id, {
      label: value.id,
      width: 144,
      height: 100
    });
    console.log('creating node: ' + value.id);
  });

  _.forEach(data, function(value1, key1) {
    _.forEach(value1.childrenNodes, function(value2, key2){
      g.setEdge(value1.id, value2);
      console.log('creating edge: ' + value1.id + ' - ' + value2);
    });
  });
    
    console.log(JSON.stringify(g, null, 2));
    return g;
}

module.exports = {
  buildGraph: buildGraph
};
